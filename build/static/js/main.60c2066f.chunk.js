(this["webpackJsonpchat-react"]=this["webpackJsonpchat-react"]||[]).push([[0],{108:function(e,a,t){e.exports=t(125)},113:function(e,a,t){},125:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(12),o=t.n(l),c=(t(113),t(13)),i=t(19),s=t(183),u=t(170),m=t(172),d=t(174),f=t(54),p=t(175),g=t(176),h=Object(u.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}})),b=function(e){var a=h();return r.a.createElement("div",{className:a.root},r.a.createElement(m.a,{position:"static"},r.a.createElement(d.a,null,r.a.createElement(p.a,{edge:"start",className:a.menuButton,color:"inherit","aria-label":"menu"},r.a.createElement(g.a,null,"menu")),r.a.createElement(f.a,{variant:"h6",className:a.title},"Chat App"),e.children)))},E=t(34),v=t(181),y=t(180),j=t(94),O=t(8),w=t.n(O),x=(t(28),t(36),t(196)),C=t(3),S=Object(u.a)({sm:{width:28,height:28},md:{width:42,height:42},lg:{width:64,height:64},xl:{width:84,height:84},bg:{backgroundColor:"#ff5722"}}),N=function(e){var a=e.name,t=e.avatar,n=e.size,l=S();return r.a.createElement(x.a,{alt:a,src:t,className:Object(C.a)(l[n],t?null:l.bg)},t?null:a.charAt(0))},W=r.a.forwardRef((function(e,a){return r.a.createElement(i.b,Object.assign({ref:a,to:"/getting-started/installation/"},e))})),k=Object(E.f)((function(e){var a=e.history,t=e.user,n=e.onLogout,l=r.a.useState(null),o=Object(c.a)(l,2),i=o[0],s=o[1],u=Boolean(i),m=function(){s(null)};return r.a.createElement("div",null,r.a.createElement(p.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){s(e.currentTarget)},color:"inherit"},r.a.createElement(N,{name:t.name,avatar:t.avatar,size:"sm"})),r.a.createElement(j.a,{id:"menu-appbar",anchorEl:i,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:u,onClose:m},r.a.createElement(y.a,{disabled:!0},t.name),r.a.createElement(y.a,null,r.a.createElement(v.a,{to:"/profile",component:W,variant:"body2",onClick:m},"My profile")),r.a.createElement(y.a,{onClick:function(){s(null),w.a.auth().signOut().then((function(){n&&n(),a.push("/login")}))}},"Logout")))})),q=t(30),B=t(44),D=t(184),I=t(191),T=t(185),A=t(182),R=t(193);function U(e){return r.a.createElement(R.a,Object.assign({elevation:6,variant:"filled"},e))}var L=Object(u.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}}}})),z=function(e){var a=e.type,t=e.message,n=(e.autoclose,L()),l=r.a.useState(!0),o=Object(c.a)(l,2);o[0],o[1];return r.a.createElement("div",{className:n.root},r.a.createElement(U,{severity:a},t))},_=r.a.forwardRef((function(e,a){return r.a.createElement(i.b,Object.assign({ref:a,to:"/getting-started/installation/"},e))})),F=Object(u.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),G=Object(E.f)((function(e){var a=F(),t=Object(n.useState)({email:"",password:""}),l=Object(c.a)(t,2),o=l[0],i=l[1],u=Object(n.useState)(""),m=Object(c.a)(u,2),d=m[0],p=m[1],g=function(e){i(Object(B.a)({},o,Object(q.a)({},e.target.name,e.target.value)))};return r.a.createElement(A.a,{component:"main",maxWidth:"xs"},r.a.createElement(s.a,null),r.a.createElement("div",{className:a.paper},r.a.createElement(f.a,{component:"h1",variant:"h5"},"login to chat app"),r.a.createElement("form",{className:a.form,onSubmit:function(a){a.preventDefault(),p(""),w.a.auth().signInWithEmailAndPassword(o.email,o.password).then((function(a){e.history.push("/")})).catch((function(e){console.log(e),p(e.message)}))}},r.a.createElement(I.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,defaultValue:o.email,onChange:g}),r.a.createElement(I.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",defaultValue:o.password,onChange:g}),r.a.createElement(D.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:a.submit},"Login"),r.a.createElement(T.a,{container:!0},r.a.createElement(T.a,{item:!0},r.a.createElement(v.a,{to:"/signup",component:_,variant:"body2"},"Don't have an account? Sign Up"))))),d&&r.a.createElement(z,{type:"error",message:d,autoclose:5e3}))})),M=r.a.forwardRef((function(e,a){return r.a.createElement(i.b,Object.assign({ref:a,to:"/getting-started/installation/"},e))})),P=Object(u.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}}})),$=Object(E.f)((function(e){var a=P(),t=Object(n.useState)({name:"",email:"",password:"",avatar:""}),l=Object(c.a)(t,2),o=l[0],i=l[1],u=Object(n.useState)(null),m=Object(c.a)(u,2),d=m[0],p=m[1],g=function(e){i(Object(B.a)({},o,Object(q.a)({},e.target.name,e.target.value)))};return r.a.createElement(A.a,{component:"main",maxWidth:"xs"},r.a.createElement(s.a,null),r.a.createElement("div",{className:a.paper},r.a.createElement(f.a,{component:"h1",variant:"h5"},"registration to chat app"),r.a.createElement("form",{className:a.form,onSubmit:function(a){a.preventDefault(),p(null),w.a.auth().createUserWithEmailAndPassword(o.email,o.password).then((function(a){delete o.password,w.a.database().ref("/users/".concat(a.user.uid)).set(o),p({type:"success",message:"welcome chat"}),e.history.push("/")})).catch((function(e){console.log(e),p({type:"error",message:e.message})}))}},r.a.createElement(T.a,{container:!0,spacing:2},r.a.createElement(T.a,{item:!0,xs:12,sm:6},r.a.createElement(I.a,{autoComplete:"name",name:"name",variant:"outlined",required:!0,fullWidth:!0,id:"name",label:"name",autoFocus:!0,value:o.name,onChange:g})),r.a.createElement(T.a,{item:!0,xs:12,sm:6},r.a.createElement(I.a,{variant:"outlined",required:!0,fullWidth:!0,id:"avatar",label:"URL avatar",name:"avatar",value:o.avatar,onChange:g})),r.a.createElement(T.a,{item:!0,xs:12},r.a.createElement(I.a,{variant:"outlined",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",value:o.email,onChange:g})),r.a.createElement(T.a,{item:!0,xs:12},r.a.createElement(I.a,{variant:"outlined",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:o.password,onChange:g}))),r.a.createElement(D.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:a.submit},"Registration"),r.a.createElement(T.a,{container:!0,justify:"flex-end"},r.a.createElement(T.a,{item:!0},r.a.createElement(v.a,{to:"/login",component:M,variant:"body2"},"Already have an account? Login"))))),d&&r.a.createElement(z,{type:d.type,message:d.message,autoclose:5e3}))})),V=(t(85),r.a.forwardRef((function(e,a){return r.a.createElement(i.b,Object.assign({ref:a,to:"/getting-started/installation/"},e))}))),H=Object(u.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)},space:{marginTop:10,marginBottom:10},filename:{marginLeft:20},file:{marginTop:20,marginBottom:10}}})),J=Object(E.f)((function(e){var a=H(),t=Object(n.useState)({name:"",email:"",avatar:""}),l=Object(c.a)(t,2),o=l[0],i=l[1],u=Object(n.useState)(null),m=Object(c.a)(u,2),d=m[0],p=m[1],g=function(e){i(Object(B.a)({},o,Object(q.a)({},e.target.name,e.target.value)))};return Object(n.useEffect)((function(){w.a.auth().currentUser?w.a.database().ref("/users/".concat(w.a.auth().currentUser.uid)).once("value").then((function(e){i(e.val())})):e.history.push("/login")}),[]),r.a.createElement(A.a,{component:"main",maxWidth:"xs"},r.a.createElement(s.a,null),r.a.createElement("div",{className:a.paper},r.a.createElement(f.a,{component:"h1",variant:"h5"},"my profile"),r.a.createElement("form",{className:a.form,onSubmit:function(e){e.preventDefault(),p(null);var a=w.a.auth().currentUser;w.a.database().ref("/users/".concat(a.uid)).update(o).then((function(e){p({type:"success",text:"profile update"})})).catch((function(e){p({type:"error",text:e.message})}))}},r.a.createElement(T.a,{container:!0,justify:"center",alignItems:"center",direction:"column"},r.a.createElement(N,{name:o.name,avatar:o.avatar,size:"xl"}),r.a.createElement("span",{className:a.space},o.email)),r.a.createElement(T.a,{container:!0,spacing:2},r.a.createElement(T.a,{item:!0,xs:12,sm:6},r.a.createElement(I.a,{autoComplete:"name",name:"name",variant:"outlined",required:!0,fullWidth:!0,id:"name",label:"name",autoFocus:!0,value:o.name,onChange:g})),r.a.createElement(T.a,{item:!0,xs:12,sm:6},r.a.createElement(I.a,{variant:"outlined",required:!0,fullWidth:!0,id:"avatar",label:"URL avatar",name:"avatar",value:o.avatar,onChange:g})),r.a.createElement(T.a,{item:!0,xs:12},r.a.createElement(I.a,{variant:"outlined",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",value:o.email,onChange:g}))),r.a.createElement(D.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:a.submit},"Save profile"),r.a.createElement(T.a,{container:!0,justify:"flex-end"},r.a.createElement(T.a,{item:!0},r.a.createElement(v.a,{to:"/",component:V,variant:"body2"},"Go to chat"))))),d&&r.a.createElement(z,{type:d.type,message:d.text,autoclose:5e3}))})),K=t(93),X=t(127),Y=t(179),Q=t(195),Z=t(188),ee=t(187),ae=t(128),te=t(189),ne=t(190),re=t(192),le=Object(u.a)((function(e){return{root:{flexGrow:1},paper:{paddingBottom:20},message:{padding:"0 20px",border:"1px solid #ccc",borderRadius:8,justifyContent:"space-between",flexWrap:"nowrap"},box:{height:"100%",paddingLeft:20}}})),oe=function(){var e=le(),a=Object(n.useState)(""),t=Object(c.a)(a,2),l=t[0],o=t[1],i=function(e){e.preventDefault();var a=w.a.auth().currentUser;if(a){var t={user:a.uid,message:l,date:Date.now(),id:a.uid};w.a.database().ref("/chat").push(t).then((function(e){o("")})).catch((function(e){console.log(e),alert(e.message)}))}};return r.a.createElement(X.a,{square:!0,className:e.paper},r.a.createElement("form",{onSubmit:i},r.a.createElement(T.a,{container:!0,spacing:0,direction:"row",className:e.message},r.a.createElement(T.a,{item:!0,sx:10,xs:12},r.a.createElement(I.a,{margin:"normal",name:"message",required:!0,fullWidth:!0,id:"message",label:"message",autoFocus:!0,value:l,onChange:function(e){return o(e.target.value)}})),r.a.createElement(T.a,{item:!0,xs:2},r.a.createElement(re.a,{display:"flex",alignItems:"center",className:e.box},r.a.createElement(D.a,{variant:"contained",color:"primary",endIcon:r.a.createElement(g.a,null,"send"),fullWidth:!0,disabled:!l.length,onClick:i},"Send"))))))},ce=t(91),ie=t.n(ce),se=t(92),ue=t.n(se),me=t(197),de=t(186),fe=Object(u.a)((function(e){return{root:{position:"absolute",left:"50%",top:"40%"}}})),pe=function(e){var a=fe();return r.a.createElement("div",{className:a.root},r.a.createElement(de.a,null))},ge=Object(u.a)((function(e){return{text:{padding:e.spacing(2,2,0)},paper:{paddingBottom:50,paddingTop:15,height:"70vh"},list:{marginBottom:e.spacing(3),maxHeight:"100%",overflow:"auto"},listItem:{"&:hover $buttonDelete":{visibility:"inherit"},"&:hover $buttonEdit":{visibility:"inherit"},"&:hover $buttonFavorite":{visibility:"inherit"}},buttonDelete:{visibility:"hidden"},buttonEdit:{visibility:"hidden"},buttonFavorite:{visibility:"hidden"}}})),he=Object(E.f)((function(e){var a=e.history,t=r.a.useState(!1),l=Object(c.a)(t,2),o=l[0],i=l[1],s=r.a.useState(),u=Object(c.a)(s,2),m=u[0],d=u[1],g=Object(n.useState)(""),h=Object(c.a)(g,2),b=h[0],E=h[1],v=ge(),y=Object(n.useState)([]),j=Object(c.a)(y,2),O=j[0],x=j[1],C=Object(n.useState)(null),S=Object(c.a)(C,2),W=S[0],k=S[1],q=r.a.useState(b),B=Object(c.a)(q,2),T=B[0],R=B[1],U=Object(n.useRef)(),L=function(e){O.push(e),x(Object(K.a)(O.filter((function(a){return a.message.date!==e.date})).sort((function(e,a){return e.date-a.date})))),U.current&&(U.current.scrollTop=U.current.scrollHeight)},z=function(){i(!1)};return Object(n.useEffect)((function(){var e=w.a.database().ref("/chat");e.on("child_added",(function(e){var a=e.val();w.a.database().ref("/users/".concat(a.user)).once("value").then((function(e){a.user=e.val(),k(w.a.auth().currentUser.uid),console.log("messageitem",a),L(a)}))}),(function(e){console.log(e),e.message.includes("permission_denied")&&a.push("/login")})),e.on("child_removed",(function(e){var a=e.val();O=O.filter((function(e){return e.date!==a.date})).sort((function(e,a){return e.date-a.date})),x(O),console.log(O)}),(function(e){console.log(e),e.message.includes("permission_denied")&&a.push("/login")})),e.on("child_changed",(function(e){var a=e.val();w.a.database().ref("/users/".concat(a.user)).once("value").then((function(e){a.user=e.val(),k(w.a.auth().currentUser.uid),console.log("messageitem",a),L(a)})),O=O.filter((function(e){return e.date!==a.date})).sort((function(e,a){return e.date-a.date})),console.log("child_changed-messages",O)}),(function(e){console.log(e),e.message.includes("permission_denied")&&a.push("/login")}))}),[]),r.a.createElement(A.a,null,r.a.createElement("div",null,r.a.createElement(Q.a,{open:o,onClose:z,"aria-labelledby":"form-dialog-title"},r.a.createElement(ee.a,null,r.a.createElement(I.a,{autoFocus:!0,margin:"dense",id:"name",label:"edit message",type:"text",fullWidth:!0,defaultValue:b,onChange:function(e){R(e.target.value)}})),r.a.createElement(Z.a,null,r.a.createElement(D.a,{onClick:z,color:"primary"},"Cancel"),r.a.createElement(D.a,{onClick:function(){w.a.database().ref("chat").orderByChild("date").equalTo(m).on("value",(function(e){e.forEach((function(e){var a=w.a.database().ref("/chat/".concat(e.key)).key;w.a.database().ref("chat/".concat(a)).update({message:T}),console.log("1",O)}))})),console.log("3",O),i(!1),console.log("final-edit-message",T)},color:"primary"},"Send")))),r.a.createElement(X.a,{square:!0,className:v.paper},r.a.createElement(f.a,{className:v.text,variant:"h5",gutterBottom:!0},"Chat"),!W&&r.a.createElement(pe,null),r.a.createElement(Y.a,{className:v.list,ref:U},O.map((function(e){var a=e.date,t=e.user,n=e.message,l=e.id;return r.a.createElement(ae.a,{button:!0,key:a,className:v.listItem},r.a.createElement(te.a,null,r.a.createElement(N,{name:t.name,avatar:t.avatar,size:"md"})),r.a.createElement(ne.a,{primary:t?t.name:"anonymous",secondary:n}),W===l?r.a.createElement("div",null,r.a.createElement(me.a,{title:"Delete"},r.a.createElement(p.a,{"aria-label":"delete",className:v.buttonDelete,onClick:function(){!function(e){w.a.database().ref("chat").orderByChild("date").equalTo(e).on("value",(function(e){e.forEach((function(e){w.a.database().ref("/chat/".concat(e.key)).remove()}))}))}(a)}},r.a.createElement(ie.a,null))),r.a.createElement(me.a,{title:"Edit"},r.a.createElement(p.a,{"aria-label":"edit",className:v.buttonEdit,onClick:function(){!function(e,a){i(!0),w.a.database().ref("chat").orderByChild("date").equalTo(e).on("value",(function(t){t.forEach((function(n){console.log("snapshot-val",t.val()),console.log("child.key",w.a.database().ref("/chat/".concat(n.key))),E(a),d(e)}))}))}(a,n)}},r.a.createElement(ue.a,null)))):null)})))),r.a.createElement(oe,null))})),be=function(){return r.a.createElement(E.c,null,r.a.createElement(E.a,{exact:!0,path:"/",component:he}),r.a.createElement(E.a,{exact:!0,path:"/login",component:G}),r.a.createElement(E.a,{exact:!0,path:"/signup",component:$}),r.a.createElement(E.a,{exact:!0,path:"/profile",component:J}))};w.a.initializeApp({apiKey:"AIzaSyAc8rRwv_gUz8mXhSmYI5x8WlgCveDo3hM",authDomain:"chat-react-9a725.firebaseapp.com",databaseURL:"https://chat-react-9a725.firebaseio.com",projectId:"chat-react-9a725",storageBucket:"chat-react-9a725.appspot.com",messagingSenderId:"180298420289",appId:"1:180298420289:web:73549a94af6bd2306df6c0"});var Ee=function(){var e=Object(n.useState)(null),a=Object(c.a)(e,2),t=a[0],l=a[1];return Object(n.useEffect)((function(){w.a.auth().onAuthStateChanged((function(e){e&&w.a.database().ref("/users/".concat(e.uid)).once("value").then((function(e){l(e.val())}))}))}),[]),r.a.createElement(i.a,null,r.a.createElement(s.a,null),r.a.createElement(b,null,t&&r.a.createElement(k,{user:t,onLogout:function(){l(null)}})),r.a.createElement(be,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Ee,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[108,1,2]]]);
//# sourceMappingURL=main.60c2066f.chunk.js.map